import{useMutation as e}from"@tanstack/react-query";import t from"axios";import r,{useState as a,createElement as n,useRef as s,useEffect as o}from"react";import{Root as i,Fallback as l}from"@radix-ui/react-avatar";import{clsx as c}from"clsx";import{twMerge as d}from"tailwind-merge";import{Slot as m}from"@radix-ui/react-slot";import{cva as u}from"class-variance-authority";import{Root as f,Viewport as v,Corner as g,ScrollAreaScrollbar as b,ScrollAreaThumb as h}from"@radix-ui/react-scroll-area";import{X as p,MessageCircle as x,Bot as N,User as y,Send as w}from"lucide-react";function E(){var r=a([]),n=r[0],s=r[1],o=e({mutationFn:function(e){try{return Promise.resolve(t.post("/api/chatbot",{message:e})).then(function(e){return e.data})}catch(e){return Promise.reject(e)}},onSuccess:function(e,t){s(function(e){return[].concat(e,[{id:crypto.randomUUID(),sender:"user",text:t}])}),s(function(r){return[].concat(r,[{id:crypto.randomUUID(),sender:"user",text:t},{id:crypto.randomUUID(),sender:"bot",text:e.reply}])})}});return{messages:n,sendMessage:function(e){e.trim()&&o.mutate(e)},isLoading:o.isPending}}function k(){return(k=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(null,arguments)}function z(e,t){if(null==e)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;r[a]=e[a]}return r}function j(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return d(c(t))}var C=["className"],D=["className"];function P(e){var t=e.className,r=z(e,C);return n(i,k({"data-slot":"avatar",className:j("relative flex size-8 shrink-0 overflow-hidden rounded-full",t)},r))}function O(e){var t=e.className,r=z(e,D);return n(l,k({"data-slot":"avatar-fallback",className:j("bg-muted flex size-full items-center justify-center rounded-full",t)},r))}var U=["className","variant","size","asChild"],A=u("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function I(e){var t=e.className,r=e.variant,a=e.size,s=e.asChild,o=void 0!==s&&s,i=z(e,U);return n(o?m:"button",k({"data-slot":"button",className:j(A({variant:r,size:a,className:t}))},i))}var M=["className"];function S(e){var t=e.className,r=z(e,M);return n("div",k({"data-slot":"card",className:j("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border shadow-sm",t)},r))}var V=["className","type"];function _(e){var t=e.className,r=e.type,a=z(e,V);return n("input",k({type:r,"data-slot":"input",className:j("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t)},a))}var K=["className","children"],T=["className","orientation"];function q(e){var t=e.className,r=e.children,a=z(e,K);return n(f,k({"data-slot":"scroll-area",className:j("relative",t)},a),n(v,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1"},r),n(F,null),n(g,null))}function F(e){var t=e.className,r=e.orientation,a=void 0===r?"vertical":r,s=z(e,T);return n(b,k({"data-slot":"scroll-area-scrollbar",orientation:a,className:j("flex touch-none p-px transition-colors select-none","vertical"===a&&"h-full w-2.5 border-l border-l-transparent","horizontal"===a&&"h-2.5 flex-col border-t border-t-transparent",t)},s),n(h,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"}))}var L=function(e){var t=e.initialMessages,n=void 0===t?[]:t,i=e.placeholder,l=void 0===i?"Digite sua mensagem...":i,c=e.onSendMessage,d=e.position,m=void 0===d?"left":d,u=e.primaryColor,f=void 0===u?"hsl(var(--primary))":u,v=e.title,g=void 0===v?"Assistente Virtual":v,b=e.welcomeMessage,h=void 0===b?"Olá! Como posso ajudá-lo hoje?":b,E=e.onToggle,k=e.defaultOpen,z=e.className,C=a(void 0!==k&&k),D=C[0],U=C[1],A=a(n.length>0?n:[{id:"1",role:"bot",content:h,createdAt:new Date}]),M=A[0],V=A[1],K=a(""),T=K[0],F=K[1],L=a(!1),R=L[0],B=L[1],G=s(null),H=s(null);o(function(){var e;null===(e=G.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[M]),o(function(){D&&H.current&&H.current.focus()},[D]);var J=function(){var e=!D;U(e),null==E||E(e)},Q=function(){try{if(!T.trim())return Promise.resolve();var e={id:Date.now().toString(),role:"user",content:T,createdAt:new Date};return V(function(t){return[].concat(t,[e])}),F(""),null==c||c(T),B(!0),setTimeout(function(){var e={id:(Date.now()+1).toString(),role:"bot",content:'Obrigado pela sua mensagem: "'+T+'". Como posso ajudá-lo mais?',createdAt:new Date};V(function(t){return[].concat(t,[e])}),B(!1)},1500),Promise.resolve()}catch(e){return Promise.reject(e)}};return r.createElement("div",{className:j("fixed z-50",z)},r.createElement("div",{className:j("fixed",{left:"left-6 bottom-6",right:"right-6 bottom-6"}[m])},r.createElement(I,{onClick:J,size:"lg",className:j("h-14 w-14 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-110",D&&"rotate-180"),style:{backgroundColor:f}},r.createElement(D?p:x,{className:"h-6 w-6"}))),D&&r.createElement("div",{className:j("fixed",{left:"left-6 bottom-24",right:"right-6 bottom-24"}[m])},r.createElement(S,{className:"w-80 h-96 shadow-2xl animate-in slide-in-from-bottom-5 duration-300"},r.createElement("div",{className:"flex items-center justify-between p-4 border-b rounded-t-lg text-white",style:{backgroundColor:f}},r.createElement("div",{className:"flex items-center gap-2"},r.createElement(P,{className:"h-8 w-8"},r.createElement(O,{className:"bg-white/20"},r.createElement(N,{className:"h-4 w-4"}))),r.createElement("h3",{className:"font-semibold text-sm"},g)),r.createElement(I,{variant:"ghost",size:"sm",onClick:J,className:"text-white hover:bg-white/20 h-8 w-8 p-0"},r.createElement(p,{className:"h-4 w-4"}))),r.createElement(q,{className:"flex-1 p-4 h-53"},r.createElement("div",{className:"space-y-4"},M.map(function(e){return r.createElement("div",{key:e.id,className:j("flex gap-2","user"===e.role?"justify-end":"justify-start")},"bot"===e.role&&r.createElement(P,{className:"h-6 w-6 mt-1"},r.createElement(O,{className:"bg-muted"},r.createElement(N,{className:"h-3 w-3"}))),r.createElement("div",{className:j("max-w-[70%] rounded-lg px-3 py-2 text-sm","user"===e.role?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground")},e.content),"user"===e.role&&r.createElement(P,{className:"h-6 w-6 mt-1"},r.createElement(O,{className:"bg-primary"},r.createElement(y,{className:"h-3 w-3 text-primary-foreground"}))))}),R&&r.createElement("div",{className:"flex gap-2 justify-start"},r.createElement(P,{className:"h-6 w-6 mt-1"},r.createElement(O,{className:"bg-muted"},r.createElement(N,{className:"h-3 w-3"}))),r.createElement("div",{className:"bg-muted rounded-lg px-3 py-2"},r.createElement("div",{className:"flex gap-1"},r.createElement("div",{className:"w-2 h-2 bg-muted-foreground rounded-full animate-bounce"}),r.createElement("div",{className:"w-2 h-2 bg-muted-foreground rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),r.createElement("div",{className:"w-2 h-2 bg-muted-foreground rounded-full animate-bounce",style:{animationDelay:"0.2s"}})))),r.createElement("div",{ref:G}))),r.createElement("div",{className:"p-4 border-t"},r.createElement("div",{className:"flex gap-2"},r.createElement(_,{ref:H,value:T,onChange:function(e){return F(e.target.value)},onKeyPress:function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),Q())},placeholder:l,className:"flex-1"}),r.createElement(I,{onClick:Q,size:"sm",disabled:!T.trim(),style:{backgroundColor:f}},r.createElement(w,{className:"h-4 w-4"})))))))};export{L as ChatWidget,E as useChatbot};
//# sourceMappingURL=index.modern.js.map
